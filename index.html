<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Interés Compuesto Diario</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #ffffff;
      margin: 0;
      padding: 2rem;
    }

    h1 {
      text-align: center;
      color: #00e676;
      margin-bottom: 2rem;
    }

    .formulario {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .formulario input {
      padding: 0.8rem;
      border: none;
      border-radius: 6px;
      width: 200px;
      font-size: 1rem;
    }

    .formulario button {
      background-color: #00e676;
      color: #000;
      padding: 0.8rem 1.2rem;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      font-size: 1rem;
    }

    .formulario button:hover {
      background-color: #00c853;
    }

    .etiquetas {
      display: flex;
      justify-content: center;
      gap: 3rem;
      margin: 2rem 0 1rem;
      flex-wrap: wrap;
    }

    .etiqueta {
      background-color: #1e1e1e;
      padding: 1rem 2rem;
      border-radius: 10px;
      font-size: 1.4rem;
      font-weight: bold;
      color: #ffffff;
      box-shadow: 0 0 10px rgba(0, 230, 118, 0.2);
      transition: transform 0.3s ease;
    }

    .etiqueta:hover {
      transform: scale(1.05);
    }

    .meta { color: #00e676; }
    .real { color: #ffcc00; }
    .dif { color: #ffffff; }

    .positivo-dif { color: #00e676; }
    .negativo-dif { color: #ff5252; }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    th, td {
      padding: 0.75rem 1rem;
      text-align: center;
    }

    th {
      background-color: #1e1e1e;
      color: #00e676;
    }

    tr:nth-child(even) {
      background-color: #1a1a1a;
    }

    tr:nth-child(odd) {
      background-color: #222;
    }

    input.monto-alcanzado, input.deposito-extra {
      width: 100px;
      padding: 5px;
      border-radius: 4px;
      border: none;
      background-color: #333;
      color: #fff;
      text-align: right;
    }

    .positivo {
      color: #00e676;
    }

    .negativo {
      color: #ff5252;
    }
  </style>
</head>
<body>

  <h1>Calculadora de Interés Compuesto Diario</h1>

  <div class="formulario">
    <input type="number" id="capital" placeholder="Capital Inicial" />
    <input type="number" id="interes" placeholder="Interés Diario (%)" step="0.01" />
    <input type="number" id="meses" placeholder="Cantidad de Meses" min="1" />
    <button onclick="generarInteres()">Generar</button>
  </div>

  <div class="etiquetas">
    <div class="etiqueta meta">Meta Final:<br><span id="metaFinal">$ 0.00</span></div>
    <div class="etiqueta real">Monto Real:<br><span id="montoReal">$ 0.00</span></div>
    <div class="etiqueta dif">Diferencia Total:<br><span id="diferenciaTotal">$ 0.00</span></div>
  </div>

  <table id="tablaResultados">
    <thead>
      <tr>
        <th>Mes</th>
        <th>Saldo Inicial</th>
        <th>Depósito Extra</th>
        <th>Interés</th>
        <th>Estimado</th>
        <th>Monto Alcanzado</th>
        <th>Diferencia</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let metaFinalGlobal = 0;

    function guardarDatos() {
      const capital = document.getElementById("capital").value;
      const interes = document.getElementById("interes").value;
      const meses = document.getElementById("meses").value;
      const datosMeses = [];

      document.querySelectorAll("#tablaResultados tbody tr").forEach((fila, i) => {
        const monto = fila.querySelector(".monto-alcanzado")?.value || "";
        const deposito = fila.querySelector(".deposito-extra")?.value || "";
        datosMeses.push({ monto, deposito });
      });

      const datos = { capital, interes, meses, datosMeses };
      localStorage.setItem("datosInteres", JSON.stringify(datos));
    }

    function cargarDatos() {
      const datos = JSON.parse(localStorage.getItem("datosInteres"));
      if (datos) {
        document.getElementById("capital").value = datos.capital || "";
        document.getElementById("interes").value = datos.interes || "";
        document.getElementById("meses").value = datos.meses || "";
        if (datos.capital && datos.interes && datos.meses) {
          generarInteres(() => {
            datos.datosMeses?.forEach((d, i) => {
              const fila = document.querySelectorAll("#tablaResultados tbody tr")[i];
              if (fila) {
                fila.querySelector(".monto-alcanzado").value = d.monto || "";
                fila.querySelector(".deposito-extra").value = d.deposito || "";
              }
            });
            recalcularConMontosReales();
          });
        }
      }
    }

    function generarInteres(callback) {
      const capitalInicial = parseFloat(document.getElementById('capital').value);
      const interesDiario = parseFloat(document.getElementById('interes').value) / 100;
      const cantidadMeses = parseInt(document.getElementById('meses').value);
      const diasPorMes = 30;
      const tbody = document.querySelector("#tablaResultados tbody");
      tbody.innerHTML = "";

      if (isNaN(capitalInicial) || isNaN(interesDiario) || isNaN(cantidadMeses)) {
        alert("Por favor, ingresa valores válidos.");
        return;
      }

      let saldo = capitalInicial;
      let metaFinal = 0;

      for (let mes = 1; mes <= cantidadMeses; mes++) {
        const fila = document.createElement("tr");
        fila.innerHTML = `
          <td>Mes ${mes}</td>
          <td>$ <span class="saldo-inicial">${saldo.toFixed(2)}</span></td>
          <td><input class="deposito-extra" type="number" data-mes="${mes}" placeholder="$" /></td>
          <td class="interes">--</td>
          <td class="estimado">--</td>
          <td><input class="monto-alcanzado" type="number" data-mes="${mes}" placeholder="$" /></td>
          <td class="diferencia">--</td>
        `;
        tbody.appendChild(fila);
        saldo = saldo * Math.pow(1 + interesDiario, diasPorMes);
        metaFinal = saldo;
      }

      metaFinalGlobal = metaFinal;
      document.getElementById("metaFinal").textContent = `$ ${metaFinal.toFixed(2)}`;
      recalcularConMontosReales();

      document.querySelectorAll(".monto-alcanzado, .deposito-extra").forEach(input => {
        input.addEventListener("input", () => {
          recalcularConMontosReales();
          guardarDatos();
        });
      });

      guardarDatos();
      if (callback) callback();
    }

    function recalcularConMontosReales() {
      const interesDiario = parseFloat(document.getElementById('interes').value) / 100;
      const diasPorMes = 30;
      const filas = document.querySelectorAll("#tablaResultados tbody tr");
      let saldo = parseFloat(document.getElementById('capital').value);
      let sumaReal = 0;

      filas.forEach((fila) => {
        const inputDeposito = fila.querySelector(".deposito-extra");
        const deposito = parseFloat(inputDeposito.value) || 0;
        const saldoInicial = saldo;
        const saldoConDeposito = saldo + deposito;

        const estimado = saldoConDeposito * Math.pow(1 + interesDiario, diasPorMes);
        const interes = estimado - saldoConDeposito;

        fila.querySelector(".saldo-inicial").textContent = saldoInicial.toFixed(2);
        fila.querySelector(".interes").textContent = `$ ${interes.toFixed(2)}`;
        fila.querySelector(".estimado").textContent = `$ ${estimado.toFixed(2)}`;

        const inputReal = fila.querySelector(".monto-alcanzado");
        const diferenciaCell = fila.querySelector(".diferencia");
        const real = parseFloat(inputReal.value);

        if (!isNaN(real)) {
          const diferencia = real - estimado;
          diferenciaCell.innerHTML = `${diferencia >= 0 ? "+" : ""}$ ${diferencia.toFixed(2)}`;
          diferenciaCell.className = "diferencia " + (diferencia >= 0 ? "positivo" : "negativo");
          saldo = real;
          sumaReal += real;
        } else {
          diferenciaCell.innerHTML = "--";
          diferenciaCell.className = "diferencia";
          saldo = estimado;
        }
      });

      document.getElementById("montoReal").textContent = `$ ${sumaReal.toFixed(2)}`;
      const difTotal = sumaReal - metaFinalGlobal;
      const difSpan = document.getElementById("diferenciaTotal");

      difSpan.textContent = `${difTotal >= 0 ? "+" : ""}$ ${difTotal.toFixed(2)}`;
      difSpan.className = difTotal >= 0 ? "positivo-dif" : "negativo-dif";
    }

    window.addEventListener("DOMContentLoaded", cargarDatos);

    ["capital", "interes", "meses"].forEach(id => {
      document.getElementById(id).addEventListener("input", guardarDatos);
    });
  </script>

</body>
</html>
